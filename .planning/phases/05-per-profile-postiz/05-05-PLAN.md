---
phase: 05-per-profile-postiz
plan: 05
type: execute
wave: 3
depends_on: ["05-01", "05-02", "05-03", "05-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can configure Postiz credentials per profile"
    - "Publishing uses profile-specific Postiz account"
    - "Quota enforcement blocks TTS when exceeded"
    - "Dashboard shows accurate activity data"
  artifacts: []
  key_links: []
---

<objective>
Visual verification of Phase 5 functionality

Purpose: Confirm all Phase 5 features work correctly through manual testing
Output: User approval of per-profile Postiz configuration, quota enforcement, and dashboard
</objective>

<execution_context>
@/home/ukfdb/.claude/get-shit-done/workflows/execute-plan.md
@/home/ukfdb/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Phase 5: Per-Profile Postiz - Complete Feature Set

1. **Backend: Profile-aware Postiz service**
   - Postiz credentials loaded from profile's tts_settings.postiz
   - Instance caching by profile_id
   - Cache invalidation when settings change

2. **Backend: Quota enforcement**
   - Monthly cost tracking per profile
   - TTS generation blocked when quota exceeded (HTTP 402)
   - Dashboard API with activity stats

3. **Frontend: Settings page enhancements**
   - Profile Activity dashboard (top of page)
   - Postiz configuration section (URL, API key, test connection)
   - Usage Limits section (monthly quota)
   - API key show/hide toggle
  </what-built>

  <how-to-verify>
**Start the servers:**
```bash
# Terminal 1: Backend
cd "/mnt/c/OBSID SRL/n8n/edit_factory"
python run.py

# Terminal 2: Frontend
cd "/mnt/c/OBSID SRL/n8n/edit_factory/frontend"
npm run dev
```

**Test 1: Settings Page Dashboard**
1. Open http://localhost:3000/settings
2. Verify "Profile Activity" card shows at top
3. Confirm video counts displayed (Projects, Clips Generated, Clips Rendered)
4. Confirm monthly costs displayed

**Test 2: Postiz Configuration**
1. Scroll to "Postiz Publishing" card
2. Enter a Postiz API URL
3. Enter a Postiz API key
4. Click show/hide toggle on API key field
5. Click "Test Connection" button
6. Click "Save Settings" and verify success message

**Test 3: Usage Limits**
1. Scroll to "Usage Limits" card
2. Enter a monthly quota (e.g., $5.00)
3. Save settings
4. Refresh page and verify quota persists
5. Check dashboard shows quota progress bar

**Test 4: Profile Switching**
1. Switch to a different profile via navbar dropdown
2. Verify Settings page shows that profile's data
3. Confirm Postiz credentials are different (or empty) per profile

**Test 5: Quota Enforcement (optional if quota set low)**
1. Set quota to $0.01
2. Try to generate TTS
3. Should receive 402 error with "quota_exceeded" message
  </how-to-verify>

  <resume-signal>
Type "approved" if all tests pass, or describe any issues found.
  </resume-signal>
</task>

</tasks>

<verification>
User completes manual verification checklist above.
</verification>

<success_criteria>
- User confirms Settings page dashboard loads correctly
- User confirms Postiz credentials can be saved per profile
- User confirms quota configuration works
- User confirms profile switching shows correct data
- User approves Phase 5 functionality
</success_criteria>

<output>
After completion, create `.planning/phases/05-per-profile-postiz/05-05-SUMMARY.md`
</output>
