---
phase: 30-frontend-error-handling-adoption
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/app/pipeline/page.tsx
  - frontend/src/app/assembly/page.tsx
  - frontend/src/app/scripts/page.tsx
  - frontend/src/app/usage/page.tsx
  - frontend/src/app/tts-library/page.tsx
  - frontend/src/components/create-feed-dialog.tsx
  - frontend/src/components/create-profile-dialog.tsx
  - frontend/src/components/video-segment-player.tsx
  - frontend/src/contexts/profile-context.tsx
  - frontend/src/hooks/use-job-polling.ts
  - frontend/src/hooks/use-batch-polling.ts
  - frontend/src/hooks/use-subtitle-settings.ts
  - frontend/src/hooks/use-local-storage-config.ts
autonomous: true
requirements: [FE-02]
gap_closure: true

must_haves:
  truths:
    - "Every remaining catch block across all pages and components calls handleApiError() instead of console.error()"
    - "Hooks and contexts that make API calls use handleApiError() for error notification"
    - "Zero console.error() calls remain in catch blocks across the entire frontend (excluding error-boundary.tsx componentDidCatch and global-error.tsx)"
  artifacts:
    - path: "frontend/src/app/pipeline/page.tsx"
      provides: "handleApiError in all catch blocks"
      contains: "handleApiError"
    - path: "frontend/src/app/assembly/page.tsx"
      provides: "handleApiError in all catch blocks"
      contains: "handleApiError"
    - path: "frontend/src/app/scripts/page.tsx"
      provides: "handleApiError in all catch blocks"
      contains: "handleApiError"
    - path: "frontend/src/app/usage/page.tsx"
      provides: "handleApiError in all catch blocks"
      contains: "handleApiError"
    - path: "frontend/src/contexts/profile-context.tsx"
      provides: "handleApiError in API error catch blocks"
      contains: "handleApiError"
  key_links:
    - from: "all page/component files"
      to: "frontend/src/lib/api-error.ts"
      via: "import { handleApiError } from '@/lib/api'"
      pattern: "handleApiError"
---

<objective>
Replace all remaining console.error() calls in catch blocks with handleApiError() across pages (pipeline, assembly, scripts, usage, tts-library), components (create-feed-dialog, create-profile-dialog, video-segment-player), hooks (use-job-polling, use-batch-polling, use-subtitle-settings, use-local-storage-config), and contexts (profile-context).

Purpose: Complete FE-02 adoption across the remaining ~19 console.error occurrences. After this plan + Plan 01, zero console.error remains in any catch block.
Output: 13 updated files with zero console.error in catch blocks.
</objective>

<execution_context>
@/home/ukfdb/.claude/get-shit-done/workflows/execute-plan.md
@/home/ukfdb/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/lib/api-error.ts
@frontend/src/lib/api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace console.error in page files (pipeline, assembly, scripts, usage, tts-library)</name>
  <files>
    frontend/src/app/pipeline/page.tsx
    frontend/src/app/assembly/page.tsx
    frontend/src/app/scripts/page.tsx
    frontend/src/app/usage/page.tsx
    frontend/src/app/tts-library/page.tsx
  </files>
  <action>
For each page file:
1. Add `import { handleApiError } from "@/lib/api"` (handleApiError is re-exported from api.ts alongside apiGet, apiPost, etc.)
2. Find every `catch` block containing `console.error(...)` and replace with `handleApiError(error, "Romanian context message")`.
3. Keep any state cleanup code (setLoading(false), etc.) — handleApiError only handles the toast notification.
4. Remove the console.error line entirely (no double-logging).

Context messages by page:
- **pipeline/page.tsx** (4 occurrences): Use context like "Eroare la pipeline", "Eroare la generare variante", etc.
- **assembly/page.tsx** (4 occurrences): Use context like "Eroare la asamblare", "Eroare la incarcarea datelor", etc.
- **scripts/page.tsx** (3 occurrences): Use context like "Eroare la scripturi", "Eroare la generare script", etc.
- **usage/page.tsx** (3 occurrences): Use context like "Eroare la statistici", "Eroare la incarcarea costurilor", etc.
- **tts-library/page.tsx** (1 occurrence): Use context like "Eroare la biblioteca TTS".

**Important:** The `error` variable name in the catch may vary (err, error, e) — pass whatever the catch uses as first arg to handleApiError.
  </action>
  <verify>
Run: `grep -c "console.error" frontend/src/app/pipeline/page.tsx frontend/src/app/assembly/page.tsx frontend/src/app/scripts/page.tsx frontend/src/app/usage/page.tsx frontend/src/app/tts-library/page.tsx` — all should return 0.
Run: `grep -c "handleApiError" frontend/src/app/pipeline/page.tsx` — should be >= 3.
  </verify>
  <done>
Zero console.error calls in catch blocks across all 5 page files. All replaced with handleApiError() calls with descriptive Romanian context messages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace console.error in components, hooks, and contexts</name>
  <files>
    frontend/src/components/create-feed-dialog.tsx
    frontend/src/components/create-profile-dialog.tsx
    frontend/src/components/video-segment-player.tsx
    frontend/src/contexts/profile-context.tsx
    frontend/src/hooks/use-job-polling.ts
    frontend/src/hooks/use-batch-polling.ts
    frontend/src/hooks/use-subtitle-settings.ts
    frontend/src/hooks/use-local-storage-config.ts
  </files>
  <action>
For each file:
1. Add `import { handleApiError } from "@/lib/api"` if the file makes API calls.
2. Replace `console.error(...)` in catch blocks with `handleApiError(error, "context")`.

**Special cases:**
- **profile-context.tsx** (2 occurrences): These are profile fetch errors — use `handleApiError(error, "Eroare la incarcarea profilului")`. If the console.error is for a non-API error (e.g., localStorage parsing), use `handleApiError(error, "Eroare la context profil")`.
- **use-job-polling.ts** and **use-batch-polling.ts** (1 each): These are polling errors. Use `handleApiError(error, "Eroare la actualizarea statusului")`. Note: polling hooks may fire frequently — handleApiError is idempotent (shows toast) so this is acceptable, but if the hook already has error suppression logic, preserve it and add handleApiError where real errors surface.
- **use-subtitle-settings.ts** and **use-local-storage-config.ts** (2 each): These may be localStorage parse errors, not API errors. For non-API errors, still replace console.error with `handleApiError(error, "Eroare la setari")` — handleApiError handles non-ApiError types via its fallback message.
- **auth-provider.tsx** (5 occurrences): **SKIP THIS FILE**. Auth errors in the auth provider are infrastructure — they log before redirects and during session management. Changing these to toasts could create confusing UX during login/logout flows.
- **error-boundary.tsx** (1 occurrence): **SKIP THIS FILE**. componentDidCatch console.error is standard React error boundary behavior.
- **global-error.tsx** (1 occurrence): **SKIP THIS FILE**. Next.js root error boundary.

**create-feed-dialog.tsx** and **create-profile-dialog.tsx** (1 each): Replace with handleApiError.
**video-segment-player.tsx** (1): Replace with handleApiError.
  </action>
  <verify>
Run: `grep -c "console.error" frontend/src/components/create-feed-dialog.tsx frontend/src/components/create-profile-dialog.tsx frontend/src/components/video-segment-player.tsx frontend/src/contexts/profile-context.tsx frontend/src/hooks/use-job-polling.ts frontend/src/hooks/use-batch-polling.ts frontend/src/hooks/use-subtitle-settings.ts frontend/src/hooks/use-local-storage-config.ts` — all should return 0.
Verify skipped files still have their original console.error: `grep -c "console.error" frontend/src/components/error-boundary.tsx frontend/src/app/global-error.tsx frontend/src/components/auth-provider.tsx` — these should NOT be 0 (they keep their console.error).
  </verify>
  <done>
Zero console.error calls in catch blocks across all 8 target files. Infrastructure files (error-boundary, global-error, auth-provider) left unchanged. All API and UI errors now route through handleApiError for consistent toast notification.
  </done>
</task>

</tasks>

<verification>
1. Full sweep: `grep -rn "console.error" frontend/src/app/ frontend/src/components/ frontend/src/hooks/ frontend/src/contexts/ --include="*.tsx" --include="*.ts" | grep -v "error-boundary" | grep -v "global-error" | grep -v "auth-provider"` — zero matches
2. Frontend builds: `cd frontend && npx next build 2>&1 | tail -5`
</verification>

<success_criteria>
- Zero console.error() in catch blocks across all 13 target files
- handleApiError imported and called in every catch block
- auth-provider.tsx, error-boundary.tsx, global-error.tsx intentionally unchanged
- Frontend compiles without TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/30-frontend-error-handling-adoption/30-02-SUMMARY.md`
</output>
